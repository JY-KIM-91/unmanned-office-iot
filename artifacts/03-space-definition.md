# 공간별 기능 정의서 (Space-Function Definition)
**무인 오피스 공간 유형별 시스템 동작 요건**

---

## 문서 목적

이 문서는 공유 오피스 내 물리적 공간을 4가지 Zone으로 분류하고,
각 Zone에서 **시스템이 수행해야 할 기능**을 정의한다.

**핵심 원칙:**
- 공간의 특성에 따라 출입 조건, 환경 제어, 관리 로직이 다르다.
- 하드웨어 스펙이 아닌 **시스템이 해야 할 일(Action)**에 집중한다.
- 3가지 평면도 유형(독립형, 프리미엄, 전층형)에 모두 적용 가능해야 한다.

---

## 1. Zone 분류 체계

### Zone 분류 기준

공간은 **접근 권한의 제약 수준**과 **이용 조건의 복잡도**에 따라 4가지로 분류된다.

| Zone | 설명 | 대표 공간 | 접근 권한 범위 | 이용 조건 |
|------|------|----------|--------------|----------|
| **Public Zone** | 건물/지점 진입 지점 | 1층 메인 출입구, 로비 | 입주사 전체 + 승인된 방문객 | 카드/QR 인증만 |
| **Shared Zone** | 공용 자유 이용 공간 | 라운지, 팬트리, 복도 | 입주사 전체 | 인증만 (예약 불필요) |
| **Reservation Zone** | 예약 필수 공용 공간 | 회의실, 포커스룸, 전화부스 | 예약한 사람만 | 예약 조건 충족 시 |
| **Private Zone** | 전용 사무 공간 | 개별 사무실, 팀룸 | 특정 회사(Company ID)만 | 소속 회사 인증 |

---

### Zone 구분의 핵심 차이

```
접근 권한의 범위:
Public (가장 넓음) → Shared → Reservation → Private (가장 좁음)

이용 조건의 복잡도:
Public (단순 인증) → Shared (단순 인증) → Reservation (예약 검증) → Private (그룹 검증)

환경 제어의 독립성:
Public (공통 제어) → Shared (공통 제어) → Reservation (개별 제어) → Private (개별 제어)
```

---

## 2. Zone별 상세 정의

### Zone A: Public Zone (메인 출입구)

#### 공간 특성
- 건물 또는 지점의 첫 번째 진입 지점
- 가장 많은 사람이 통과하는 공간
- 보안이 가장 중요한 경계선
- 예시: 1층 메인 출입구, 건물 로비, 엘리베이터 홀 입구

#### 대상 공간 (평면도 유형별)
- **독립형**: 1층 메인 출입구
- **프리미엄**: 1층 로비 + 엘리베이터 홀 진입
- **전층형**: 엘리베이터 홀에서 전용 층 진입문

---

#### 2.1. 입장 조건 (Access Condition)

**허용 대상:**
- 입주사 전체 (모든 회사, 모든 멤버십 등급)
- 사전 승인된 방문객 (QR 코드 소지자)
- 관리자 (CM, 본사 운영팀)

**인증 수단:**
- 실물 카드 태그
- 모바일 앱 (NFC/Bluetooth)
- QR 코드 스캔 (방문객 전용)
- 생체 인증 (선택 사항, Phase 2)

**인증 실패 시 동작:**
- 단말기 화면: "등록되지 않은 카드입니다"
- 소리 알림: "삐삐삐" (실패음)
- LED: 빨간색 점멸
- CM에게 실시간 알림: "미등록 카드 출입 시도 감지"

**특수 케이스:**
- **비상 상황 (화재/지진)**: 모든 인증 무시, 문 자동 열림
- **정전**: 배터리 백업으로 4시간 작동, 이후 수동 개폐 가능
- **네트워크 장애**: 로컬 저장된 권한 목록으로 오프라인 인증 (최근 24시간 동기화 데이터)

---

#### 2.2. 환경 제어 (Environment)

**조명:**
- 24시간 상시 점등 (보안상 어둡지 않아야 함)
- 야간 모드 (22:00~06:00): 밝기 50% 감소
- 출입 시 조명 밝기 순간 100% 증가 (환영 효과)

**온도:**
- 계절별 기본 온도 유지
  - 여름 (6~9월): 24~26도
  - 겨울 (12~2월): 20~22도
  - 봄/가을: 22~24도
- 외부 온도와 연동 (외부 30도 이상 시 냉방 강화)

**공기질:**
- 환기 시스템 상시 가동 (미세먼지 PM2.5 기준)
- 공기질 나쁨 시 단말기 화면에 안내: "오늘 미세먼지 농도 높음"

**음향:**
- 출입 성공 시: "환영합니다" 음성 안내 (선택 사항)
- 아침 출근 시간대 (08~10시): "좋은 아침입니다" 특별 멘트

---

#### 2.3. 관리 로직 (Admin Logic)

**출입 기록 저장:**
- 누가 (회원 ID)
- 언제 (날짜, 시각, 밀리초 단위)
- 어디서 (지점, 단말기 ID)
- 어떻게 (카드/QR/앱)
- 성공/실패 여부

**이상 징후 감지:**
- 3회 연속 인증 실패 → CM에게 즉시 알림
- 심야 출입 (22:00~06:00) → 기록 강조 표시 (빨간색)
- 퇴실 없이 24시간 이상 재실 → "장기 체류 감지" 알림
- 동일 카드로 1분 내 타 지점 출입 시도 → "카드 복제 의심" 경고

**통계 수집:**
- 시간대별 출입 인원 (피크 타임 분석)
- 요일별 출입 패턴 (주말 이용률)
- 평균 재실 시간 (입실~퇴실)

**비상 대응:**
- CM이 원격으로 "긴급 잠금" 버튼 클릭 시 즉시 출입 차단
- "긴급 개방" 버튼 클릭 시 모든 문 자동 열림
- 화재 경보기 연동: 경보 감지 시 자동 개방

---

### Zone B: Shared Zone (공용 자유 이용 공간)

#### 공간 특성
- 입주사 전체가 자유롭게 이용하는 공간
- 예약 없이 선착순 이용
- 비교적 개방적이고 캐주얼한 공간
- 예시: 라운지, 팬트리, 프린터실, 복도, 화장실 앞

#### 대상 공간 (평면도 유형별)
- **독립형**: 2~5층 복도, 라운지, 팬트리
- **프리미엄**: 층별 라운지, 오픈 라운지, 공용 팬트리
- **전층형**: 전용 층 내부 복도, 휴게 공간

---

#### 2.1. 입장 조건 (Access Condition)

**허용 대상:**
- 입주사 전체 (회사 구분 없이)
- 방문객은 불가 (입주사 동행 시에만 가능)

**인증 수단:**
- Public Zone 통과 후 재인증 (층별 복도 진입 시)
- 카드/앱 태그

**멤버십 등급별 차등 없음:**
- Single Spot, All Access 모두 동일하게 이용 가능
- 단, Hot Desk 회원은 예약 시간 외 출입 불가

**시간 제약:**
- 기본: 24시간 이용 가능
- 단, 지점 정책에 따라 야간 제한 가능 (22:00~06:00)

---

#### 2.2. 환경 제어 (Environment)

**조명:**
- **자동 점등/소등 (재실 감지 기반)**
  - 사람 감지 → 조명 켜짐
  - 30분간 재실 감지 없음 → 조명 자동 소등
  - 낮 시간 (자연광 충분 시) → 조명 50% 밝기

**온도:**
- 공용 공간이므로 개별 제어 불가
- 중앙 집중식 온도 제어
- 재실 인원 5명 이상 시 냉방 강화 (여름철)

**음향:**
- 배경 음악 재생 (선택 사항)
- 볼륨: 대화에 방해되지 않는 수준 (30dB)
- 심야 시간대 (22:00 이후) 음악 중단

**환기:**
- 재실 인원에 따라 환기 강도 자동 조절
- 10명 이상 → 환기 100%
- 5명 이하 → 환기 50%

---

#### 2.3. 관리 로직 (Admin Logic)

**재실 인원 카운트:**
- 실시간 재실 인원 측정
- CM 앱에 표시: "현재 3층 라운지 12명 이용 중"
- 혼잡도 표시: "여유" / "보통" / "혼잡"
- 회원 앱에도 공개 (다른 층 선택 유도)

**공간 활용률 분석:**
- 시간대별 평균 이용 인원
- 가장 인기 있는 공간 파악
- 공간 재배치 의사 결정 자료

**청소 알림:**
- 일정 인원 이용 후 (누적 50명) → "청소 필요" 알림
- CM에게 푸시: "3층 팬트리 청소 필요"

**소음 모니터링 (선택 사항):**
- 소음 센서로 70dB 이상 감지 시
- 화면에 "조용히 해주세요" 안내 표시

---

### Zone C: Reservation Zone (예약 필수 공간)

#### 공간 특성
- 예약을 통해서만 이용 가능한 공간
- 시간대별로 이용자가 바뀜
- 가장 복잡한 제어 로직 필요
- 예시: 회의실, 포커스룸, 전화부스, 세미나룸

#### 대상 공간 (평면도 유형별)
- **독립형**: 층별 회의실 A/B/C, 전화부스
- **프리미엄**: 대형 회의실, 중형 회의실, 전화부스
- **전층형**: 전용 층 내부 회의실 (입주사 전용이지만 예약 필요)

---

#### 2.1. 입장 조건 (Access Condition)

**허용 대상:**
- 해당 시간대에 예약한 회원만
- 예약자가 동행한 방문객 (예약자 인증 후)

**인증 수단:**
- 예약자의 카드/앱 태그
- 예약 QR 코드 (예약 시 자동 발급)

**인증 프로세스:**
1. 회원이 회의실 문 앞에서 카드 태그
2. 시스템이 검증:
   - 현재 시각이 예약 시간 내인가?
   - 이 회원이 예약자인가?
3. 조건 충족 시 문 열림
4. 조건 미충족 시:
   - 화면: "예약되지 않았습니다"
   - 화면: "14:00~16:00 예약 가능" (다음 예약 시간 안내)

**시간 제약:**
- **예약 시작 5분 전부터 입장 가능**
  - 예약 시간: 14:00~16:00
  - 입장 가능 시간: 13:55~16:00
- **예약 종료 시각 이후 입장 불가**
  - 16:01 이후 태그 시 "예약 시간 종료" 표시

**예약 없이 입장 시도 시:**
- 화면: "예약이 필요합니다"
- "지금 예약하기" 버튼 표시 (앱 연동)
- 현재 예약 가능 여부 표시

---

#### 2.2. 환경 제어 (Environment)

**조명:**
- **예약 시작 시 자동 점등**
  - 13:55 (5분 전) → 조명 켜짐
- **예약 종료 후 자동 소등**
  - 16:00 예약 종료
  - 퇴실 감지 후 1분 뒤 소등
  - (단, 연장 결제 시 소등 연기)

**온도:**
- **예약 시작 20분 전 사전 냉난방**
  - 13:40부터 냉방/난방 가동
  - 예약 시작 시각에 쾌적한 온도 도달
- **예약 종료 후 절전 모드**
  - 16:00 이후 냉난방 중단
  - (단, 연장 결제 시 계속 가동)

**화면 (회의실 내부):**
- 예약 정보 표시:
  - "ABC사 마케팅팀 (14:00~16:00)"
  - "남은 시간: 1시간 30분"
- 종료 10분 전 경고:
  - "퇴실 10분 전입니다"
  - 화면 색상 노란색으로 변경
- 종료 시각:
  - "예약 시간이 종료되었습니다"
  - "연장 사용 시 10분당 3,500원"
  - "퇴실 버튼" 표시

**음향 안내:**
- 종료 10분 전: "띵" (차임벨 1회)
- 종료 시각: "띵띵" (차임벨 2회)

---

#### 2.3. 관리 로직 (Admin Logic)

**예약 시간 엄격 검증:**
- 예약 시작 전 입장 시도 → "아직 예약 시간이 아닙니다"
- 예약 종료 후 퇴실 안 할 시 → 초과 이용 자동 감지

**초과 이용 감지 및 과금:**
- 퇴실 감지 센서로 실제 퇴실 시각 측정
- 16:00 종료 예약인데 16:20 퇴실 감지 시:
  - 초과 시간: 20분
  - 추가 요금: 3,500원 x 2회 = 7,000원
- 예약자 앱에 즉시 알림: "20분 초과 이용, 7,000원 청구 예정"

**연장 기능:**
- 예약 종료 10분 전부터 앱에 "연장하기" 버튼 활성화
- 연장 가능 여부 자동 확인:
  - 다음 예약 있음 → "연장 불가 (16:00~18:00 예약 있음)"
  - 다음 예약 없음 → "30분 연장 가능 (1만원)"
- 결제 완료 시 예약 시간 자동 연장, 환경 제어 계속 유지

**노쇼(No-show) 처리:**
- 예약 시작 후 15분 이내 입장 없을 시:
  - 시스템이 자동으로 "노쇼" 판정
  - 예약 자동 취소
  - 예약자에게 페널티 부과 (선택 사항: 다음 예약 제한 1회)
  - 다른 회원에게 "예약 가능" 상태로 전환

**퇴실 확인:**
- 예약 종료 시각 이후에도 재실 감지 시:
  - 5분 경과 → 앱 푸시: "회의실 A에 아직 계신가요?"
  - 10분 경과 → 초과 이용 시작 (자동 과금)
  - 30분 경과 → CM에게 알림: "회의실 A 장기 체류, 확인 필요"

**청소 알림:**
- 예약 종료 후 퇴실 감지 시:
  - CM에게 "회의실 A 청소 필요" 알림
  - 다음 예약 시작 20분 전까지 청소 완료 필요
  - 청소 완료 버튼 클릭 시 알림 해제

**예약 통계:**
- 회의실별 예약률 (일/주/월)
- 가장 인기 있는 시간대 (14:00~16:00 예약 많음)
- 노쇼율, 초과 이용 빈도
- 평균 이용 시간

---

### Zone D: Private Zone (개별 전용 공간)

#### 공간 특성
- 특정 회사(입주사)만 이용하는 전용 공간
- 가장 높은 보안 수준
- 개별 환경 제어 필요
- 예시: 독립 사무실, 팀룸, 개인 오피스

#### 대상 공간 (평면도 유형별)
- **독립형**: 5층 Zone-1, Zone-2, Zone-3 (각 회사별 독립 공간)
- **프리미엄**: 독립 사무실 A/B/C (문 있는 폐쇄 공간)
- **전층형**: 전체 층을 하나의 회사가 전용 (엘리베이터 홀부터 Private)

---

#### 2.1. 입장 조건 (Access Condition)

**허용 대상:**
- 해당 회사(Company ID)에 속한 직원만
- 해당 회사가 초대한 방문객 (회사 전용 QR)

**인증 수단:**
- 회사 소속 직원의 카드/앱
- 회사 전용 방문객 QR

**인증 프로세스:**
1. 회원이 Private Zone 문 앞에서 카드 태그
2. 시스템이 검증:
   - 이 회원의 Company ID가 이 공간의 권한 목록에 있는가?
3. 조건 충족 시 문 열림
4. 조건 미충족 시:
   - 화면: "출입 권한이 없습니다"
   - 화면: "이 공간은 ABC사 전용입니다"

**타 회사 직원 출입 시도 시:**
- 같은 입주사여도 다른 회사 → 출입 불가
- 화면: "권한이 없습니다. 소속 회사 공간으로 이동하세요"

**방문객 처리:**
- 입주사가 발급한 방문객 QR은 Public/Shared만 허용
- Private Zone 방문 시 별도 "회사 전용 방문객 QR" 필요
- 입주사 직원이 앱에서 "우리 사무실 방문객 초대" 기능 사용

---

#### 2.2. 환경 제어 (Environment)

**조명:**
- **첫 출근 시 자동 점등**
  - 오늘 첫 번째 직원 입실 감지 → 전체 조명 켜짐
  - 순차 점등 효과 (입구 → 내부 순서로 켜짐)
- **마지막 퇴근 시 자동 소등**
  - 마지막 직원 퇴실 감지 → 10분 후 전체 조명 소등
  - 단말기 화면: "마지막 퇴실자입니다. 10분 후 자동 소등됩니다"
  - 퇴실자가 "즉시 소등" 또는 "30분 후 소등" 선택 가능
- **구역별 개별 제어**
  - 사무실 내부를 3~5개 구역으로 분할
  - 구역별로 재실 감지 및 개별 소등

**온도:**
- **출근 시간 30분 전 사전 냉난방**
  - 회사별 출근 패턴 학습 (대부분 09:00 출근 시)
  - 08:30부터 냉난방 가동
- **회사별 선호 온도 설정 가능**
  - ABC사: 여름 24도, 겨울 22도
  - XYZ사: 여름 26도, 겨울 20도
- **재실 인원에 따라 온도 자동 조정**
  - 8명 중 2명만 출근 → 냉난방 강도 50%
  - 전원 출근 → 냉난방 강도 100%

**공기질:**
- 회사 전용 공간이므로 독립 환기 제어
- 미세먼지 센서 연동
- 공기질 나쁨 시 환기 강화

**음향:**
- 회사가 자유롭게 배경 음악 재생 가능 (스피커 제공 시)
- 전화/영상 회의 중 감지 → 배경 음악 자동 음소거

---

#### 2.3. 관리 로직 (Admin Logic)

**회사별 권한 그룹 관리:**
- 회사 등록 시 자동으로 "Company ID" 생성
- 해당 회사 직원 전원에게 Company ID 자동 부여
- 신규 직원 등록 시 자동으로 그룹 권한 상속

**재실 현황 회사별 관리:**
- "ABC사 현재 5명/8명 출근 중"
- 회사 대표 또는 팀장이 앱에서 확인 가능
- 누가 출근했는지 목록 표시 (선택 사항, 프라이버시 설정)

**장기 부재 감지:**
- 3일 이상 출입 기록 없는 직원 → 회사 대표에게 알림
- "김직원 3일간 출입 기록 없음 (퇴사자인지 확인 필요)"

**에너지 절약 모드:**
- 주말/공휴일에 출근 예정자 없을 시:
  - 냉난방 자동 중단
  - 조명 소등
  - 단, 출근자 있을 시 자동 복귀

**보안 강화:**
- 야간 시간대 (22:00~06:00) 출입 시:
  - 카메라 자동 녹화 시작 (보안 목적)
  - 회사 대표에게 알림: "야간 출입 발생 (김직원)"
- 주말 출입 시 동일 처리

**회사별 출입 통계:**
- 회사별 평균 출근 시간, 퇴근 시간
- 재실률 (8명 중 평균 몇 명 출근)
- 공간 활용도 (평수 대비 이용률)

---

## 3. 특수 케이스 정의

### Case 1: 전층형 오피스의 엘리베이터 홀 처리

#### 상황 설명
전층형 오피스는 한 회사가 건물의 특정 층 전체를 사용한다.
이 경우 **엘리베이터 홀 출입문이 곧 Private Zone의 입구**가 된다.

#### 문제점
- 엘리베이터는 여러 층을 공유 → 타 회사 직원도 해당 층 버튼 누를 수 있음
- 엘리베이터 문이 열렸을 때 출입문이 잠겨 있으면 진입 불가
- 타 층으로 잘못 온 사람이 출입 시도 → 거부 시 불편

#### 해결 방안

**A. 동선 처리**
```
1. 엘리베이터 도착 (5층)
   ↓
2. 엘리베이터 문 열림
   ↓
3. 엘리베이터 홀 (공용 공간)
   ↓
4. 5층 전용 출입문 (Private Zone 시작)
   - 이 문에 단말기 설치
   - ABC사 직원만 카드 태그 후 입장
```

**B. 시스템 동작**

1. **사전 인증 (선택 사항)**
   - 회원이 1층에서 엘리베이터 탈 때 카드 태그
   - 시스템이 자동으로 소속 층(5층) 버튼 점등
   - 타 층 버튼 비활성화 (보안 강화)
   - 단, 이 방식은 엘리베이터 제조사 연동 필요 (Phase 2)

2. **후 인증 (기본 방식)**
   - 엘리베이터 홀은 공용 공간 (누구나 도착 가능)
   - 5층 전용 출입문에서 카드 인증
   - ABC사 직원 → 문 열림
   - 타 회사 직원 → 화면: "이 층은 ABC사 전용입니다. 소속 층으로 이동하세요"

3. **잘못 온 사람 안내**
   - 단말기 화면 기본 표시: "5층 - ABC사 전용 오피스"
   - 카드 태그 실패 시:
     - "출입 권한이 없습니다"
     - "3층(XYZ사) 또는 7층(DEF사)으로 이동하세요" (소속 층 안내)

4. **방문객 처리**
   - ABC사에 방문하는 손님:
     - 1층에서 방문객 QR 스캔 (Public Zone 통과)
     - 엘리베이터로 5층 이동
     - 5층 전용 출입문에서 방문객 QR 다시 스캔
     - ABC사 전용 방문객 QR만 허용 (타 회사 QR 불가)

**C. 엘리베이터 홀 구역 설정**

| 구역 | Zone 분류 | 권한 |
|-----|----------|------|
| 1층 엘리베이터 홀 | Public Zone | 입주사 전체 + 방문객 |
| 엘리베이터 내부 | Public Zone | 누구나 탑승 가능 |
| 5층 엘리베이터 홀 | Shared Zone | 입주사 전체 (도착만 가능) |
| 5층 전용 출입문 이후 | Private Zone | ABC사만 |

**D. 보안 강화 옵션 (Phase 2)**
- 엘리베이터 홀에 카메라 설치
- 5층 도착 후 출입 실패 시 카메라 자동 캡처
- 반복 실패 시 (5회 이상) → CM에게 알림

---

### Case 2: 프리미엄 오피스의 혼합 Zone 처리

#### 상황 설명
프리미엄 오피스는 한 층에 여러 Zone이 혼재한다.
- 복도: Shared Zone
- 회의실 A/B: Reservation Zone
- 독립 사무실 C: Private Zone (DEF사 전용)

#### 문제점
- 같은 층에 있지만 접근 권한이 다름
- 복도를 통해 모든 공간에 물리적 접근 가능
- 잘못된 공간 진입 시도 빈번

#### 해결 방안

**A. Zone별 단말기 설치**
```
5층 복도 진입문 (Shared Zone)
  ├─ 회의실 A 문 (Reservation Zone) → 단말기 설치
  ├─ 회의실 B 문 (Reservation Zone) → 단말기 설치
  └─ 독립 사무실 C 문 (Private Zone) → 단말기 설치
```

**B. 시스템 동작**
1. **복도 진입**: 입주사 전체 허용 (Shared Zone)
2. **회의실 진입**: 예약자만 허용 (Reservation Zone)
3. **독립 사무실 진입**: DEF사 직원만 허용 (Private Zone)

**C. 사용자 경험**
- 입주사 직원이 회의실 A 예약 없이 문 태그 시:
  - "예약이 필요합니다. 현재 14:00~16:00 예약 가능"
  - "지금 예약하기" 버튼 (앱 연동)
- 타 회사 직원이 독립 사무실 C 문 태그 시:
  - "이 공간은 DEF사 전용입니다"
  - "공용 회의실을 이용하세요"

---

### Case 3: 독립형 오피스의 층별 Zone 처리

#### 상황 설명
독립형 오피스는 층마다 여러 회사가 나뉘어 입주한다.
- 3층: ABC사, XYZ사, GHI사 (각 Zone-1, 2, 3)
- 4층: DEF사, JKL사 (Zone-1, 2)

#### 문제점
- 같은 층이지만 회사별로 공간이 분리됨
- 복도는 공용, 각 Zone은 회사 전용

#### 해결 방안

**A. Zone 구조**
```
3층 복도 (Shared Zone) - 입주사 전체 통과 가능
  ├─ Zone-1 (ABC사) → Private Zone
  ├─ Zone-2 (XYZ사) → Private Zone
  └─ Zone-3 (GHI사) → Private Zone
```

**B. 시스템 동작**
1. 3층 복도 진입문: 입주사 전체 허용
2. Zone-1 문: ABC사만 허용
3. Zone-2 문: XYZ사만 허용
4. Zone-3 문: GHI사만 허용

**C. 환경 제어 독립**
- 복도 조명: 공용 (재실 감지)
- Zone-1 조명: ABC사 출퇴근 패턴에 맞춤
- Zone-2 조명: XYZ사 출퇴근 패턴에 맞춤
- 각 Zone 온도 독립 제어

---

### Case 4: 회의실 예약 후 노쇼 시 처리

#### 상황 설명
회의실을 예약했으나 실제로 사용하지 않는 경우 (No-show).

#### 문제점
- 예약은 되어 있어서 다른 사람이 예약 못 함
- 실제로는 비어 있어서 공간 낭비
- 수익 손실 (예약료 환불 이슈)

#### 해결 방안

**A. 노쇼 감지 로직**
```
1. 예약 시작 시각 (14:00)
   ↓
2. 5분 대기 (14:05까지)
   ↓
3. 재실 감지 센서 확인
   - 사람 감지 O → 정상 사용 중
   - 사람 감지 X → 노쇼 의심
   ↓
4. 10분 대기 (14:10까지)
   ↓
5. 여전히 재실 없음 → 노쇼 확정
   ↓
6. 예약 자동 취소
```

**B. 시스템 동작**
1. **예약자에게 알림**
   - 앱 푸시: "회의실 A 예약 시작 5분 전입니다"
   - 알림 무응답 시 추가 알림 없음

2. **노쇼 확정 시**
   - 예약 자동 취소
   - 예약자 앱에 알림: "회의실 A 노쇼로 예약 취소되었습니다"
   - 페널티 부과 (선택 사항):
     - 다음 예약 시 경고 메시지
     - 3회 노쇼 시 1주일 예약 제한

3. **예약 가능 상태로 전환**
   - 시스템이 자동으로 "예약 가능" 상태로 변경
   - 다른 회원에게 "회의실 A 지금 예약 가능" 푸시 (선택 사항)

4. **예약료 환불 정책**
   - 노쇼 시 예약료 환불 불가 (기본)
   - 예약 시작 1시간 전 취소 시 50% 환불
   - 예약 시작 3시간 전 취소 시 100% 환불

---

### Case 5: 화재/재난 시 비상 모드

#### 상황 설명
화재 경보기가 울리거나 재난 상황 발생 시.

#### 문제점
- 출입 통제 시스템이 모든 문을 잠가서 대피 불가
- 카드 없는 방문객은 나갈 수 없음

#### 해결 방안

**A. 비상 모드 자동 활성화**
```
화재 경보 감지
  ↓
시스템 자동 판단
  ↓
비상 모드 활성화
  ↓
모든 Zone의 모든 문 자동 개방
  ↓
인증 없이 자유롭게 통과 가능
```

**B. 시스템 동작**
1. **화재 경보기 연동**
   - 화재 경보 신호 수신 시 즉시 비상 모드

2. **모든 문 자동 개방**
   - Public, Shared, Reservation, Private 모든 Zone
   - 도어락 자동 해제
   - 문이 자동으로 열림 (전동 도어 시)

3. **단말기 화면 표시**
   - "비상 상황 - 즉시 대피하세요"
   - 빨간색 화면 + 사이렌음

4. **CM에게 긴급 알림**
   - "강남점 화재 경보 발생, 비상 모드 활성화"
   - 본사 운영팀에게도 동시 알림

5. **출입 기록 유지**
   - 비상 모드 중에도 출입 기록은 계속 저장
   - 대피 인원 파악 용도

6. **비상 모드 해제**
   - CM 또는 본사 관리자가 수동으로 해제
   - 화재 경보 해제 후에도 자동 복귀 안 됨 (안전 확인 필요)

---

### Case 6: 정전 시 시스템 동작

#### 상황 설명
건물 정전으로 전력 공급 중단.

#### 문제점
- 전자식 도어락이 작동 안 함
- 사람들이 갇히거나 나갈 수 없음

#### 해결 방안

**A. 배터리 백업**
- 모든 단말기에 배터리 내장
- 정전 시 자동으로 배터리 전원 전환
- 4시간 이상 작동 보장

**B. 정전 시 동작 모드**
1. **오프라인 인증**
   - 최근 24시간 동기화된 권한 목록으로 인증
   - 카드 태그 시 로컬 데이터베이스에서 검증
   - 네트워크 불필요

2. **출입 로그 로컬 저장**
   - 정전 중 출입 기록은 단말기 내부 메모리에 저장
   - 전력 복구 시 자동으로 서버에 동기화

3. **수동 개폐 기능**
   - 배터리 방전 시 (4시간 경과)
   - 물리적 키 또는 비상 레버로 문 개폐 가능

**C. CM 알림**
- 정전 감지 시 즉시 알림
- "강남점 정전 발생, 배터리 모드 전환"
- "예상 작동 시간: 4시간"

---

## 4. Zone 간 동선 설계

### 일반적인 동선 흐름

```
방문자 동선:
1층 출입구 (Public) → 엘리베이터 → 5층 복도 (Shared) → 회의실 A (Reservation)

입주사 직원 동선:
1층 출입구 (Public) → 엘리베이터 → 5층 복도 (Shared) → Zone-3 (Private)

타 지점 로밍 회원:
1층 출입구 (Public) → 라운지 (Shared) → 회의실 예약 시 (Reservation)
```

### Zone 간 인증 횟수

| 사용자 | 목적지 | 인증 횟수 | 인증 지점 |
|--------|--------|----------|----------|
| 입주사 직원 | 자기 사무실 | 2회 | 1층 + 5층 Zone 입구 |
| 입주사 직원 | 회의실 예약 | 3회 | 1층 + 5층 복도 + 회의실 문 |
| 방문객 | 회의실 방문 | 3회 | 1층 + 5층 복도 + 회의실 문 |
| 로밍 회원 | 라운지 이용 | 2회 | 1층 + 층별 복도 |

### 인증 간소화 (Phase 2)

- **1층 인증 시 층별 복도 자동 허용**
  - 1층에서 카드 태그 → 3시간 동안 층별 복도 재인증 불필요
  - 단, Private/Reservation Zone은 여전히 인증 필요

---

## 5. 시스템 동작 우선순위

### 우선순위 1 (P1): 보안 및 안전
1. 비상 상황 시 모든 문 자동 개방 (화재/지진)
2. 권한 없는 출입 차단
3. 출입 기록 100% 저장 (감사 추적)

### 우선순위 2 (P2): 사용자 편의
1. 카드 태그 1초 이내 문 열림
2. 명확한 피드백 (화면 + 소리 + LED)
3. 거부 시 이유 명확히 안내

### 우선순위 3 (P3): 운영 효율
1. 예약 기반 자동 권한 부여/회수
2. 초과 이용 자동 감지 및 과금
3. CM 알림 최소화 (이상 징후만)

### 우선순위 4 (P4): 에너지 절약
1. 재실 감지 기반 조명 자동 소등
2. 사전 냉난방으로 에너지 효율 극대화
3. 장기 부재 시 절전 모드

---

## 6. 성공 지표 (Space-Level KPI)

### Zone별 목표

| Zone | 핵심 지표 | 목표 |
|------|---------|------|
| Public Zone | 평균 인증 시간 | 1초 이하 |
| Shared Zone | 재실 감지 정확도 | 95% 이상 |
| Reservation Zone | 노쇼율 | 5% 이하 |
| Private Zone | 무단 출입 시도 차단율 | 100% |

### 전체 목표
- [ ] 출입 기록 누락율 0%
- [ ] 비상 상황 대응 시간 5초 이내
- [ ] 에너지 절감 목표 20% (자동 소등 효과)
- [ ] 사용자 만족도 90점 이상 (인증 편의성)

---

## 7. 다음 단계

이 공간별 기능 정의서를 바탕으로:

1. **IoT Agent**: Zone별 필요 센서 목록 및 설치 위치 설계
2. **Backend Agent**: Zone별 권한 검증 로직 및 환경 제어 규칙 설계
3. **Architecture Agent**: Zone 간 데이터 흐름 및 통신 프로토콜 정의
4. **Frontend Agent**: Zone별 단말기 화면 UI 설계

---

**문서 작성일**: 2026-02-17
**작성자**: PM Agent + Business Agent
**검토 필요**: 운영팀, 입주사 대표, 현장 CM
**핵심 메시지**: "공간의 특성에 따라 출입 조건, 환경 제어, 관리 로직이 달라진다"
